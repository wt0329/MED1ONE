<%@page import="java.time.format.TextStyle"%>
<%@page import="java.util.Locale"%>
<%@page import="java.time.DayOfWeek"%>
<%@page import="java.time.LocalDate"%>
<%@page import="java.text.SimpleDateFormat"%>
<%@page import="java.util.Date"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://www.springframework.org/tags" prefix="spring"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>

<!-- plugin css file  -->
<link rel="stylesheet"
	href="<%=request.getContextPath()%>/resources/dist/assets/plugin/datatables/responsive.dataTables.min.css">
<link rel="stylesheet"
	href="<%=request.getContextPath()%>/resources/dist/assets/plugin/datatables/dataTables.bootstrap5.min.css">

<!-- SweetAlert2 CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.7/dist/sweetalert2.min.css">

<!-- SweetAlert2 JS -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.7/dist/sweetalert2.min.js"></script>

<!--datepicker  -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.css">
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.2/css/bootstrap-responsive.css"> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.js"></script>

<!-- 모달창 이동 -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/5.0.0/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

<style>
.rezUpdateLabel{
margin-bottom: 6px;
margin-top: 20px;
}

.modal-dialog-right {
	margin-left:430px;
	margin-top:40px;
	display: flex;
	align-items: center;
	min-height: calc(100% - 1rem)
}
.modal-content{
 width:600px !important;
 background-color: #f9fbfd;
}

.modal-body{
margin-left:30px;
 width:300px !important;
}

.modal-backdrop {
	position: fixed;
	top: 0;
	left: 0;
	z-index: 1040;
	width: 100vw;
	height: 100vh;
	background-color: rgba(0, 0, 0, 0.2) !important;
}


.schedule .grid {
	border: 1px solid #f0f0f0 !important;
}

/* 탭 항목 배경색 및 클릭 시 색 변경 */
.nav-tabs .nav-link {
	background-color: #94d4c5 !important; /* 탭 배경색 */
	transition: background-color 0.3s ease !important; /* 색 변경 트랜지션 효과 */
}

.nav-tabs .nav-link.active, .nav-tabs .nav-link:hover {
	background-color: #6aab9c !important; /* 클릭 시 색 변경 */
}

.schedule-item {
	text-align: center;
	font-size: 13px;
	font-weight: 500;
	color: white;
	margin-left: 40px;

}


.top-color {
  border-top: 3px solid #6aab9c; 
}

.patientInfo th, .examPatientInfo th, .clinicPatientInfo th{
font-size: 14px;
width: 116px;;

}

.patientInfo td, .examPatientInfo td, .clinicPatientInfo td{
margin-right : 20px;
margin-bottom: 20px;
font-size: 14px;
color: blue;
width: 285px;
}
.swal2-title{
	font-size: 1.5em;
}


/*datePicker  */
 body {
    color: #000;
    overflow-x: hidden;
    overflow-y: hidden;
    height: 100%;
    background-repeat: no-repeat;
    padding: 0px !important;
}

 .container-fluid {
    padding-top: 0px !important;
    padding-bottom: 0px !important;
}
 
 .card-dp {
  box-shadow: 0px 4px 8px 0px #7986CB;
  width : 500px;
  font-size: 16px;
  font-weight: 500;
}

#dp1 {
    padding: 10px 20px !important;
    border: 1px solid #000 !important;
    border-radius: 10px;
    box-sizing: border-box;
    background-color: #616161 !important; /*pick date 박스색  */
    color: #fff !important;
    font-size: 16px;
    letter-spacing: 1px;
    width: 180px;
}

input:focus {
    -moz-box-shadow: none !important;
    -webkit-box-shadow: none !important;
    box-shadow: none !important;
    border: 1px solid #512DA8;
    outline-width: 0;
}

::placeholder {
    color: #fff;
    opacity: 1;
}

:-ms-input-placeholder {
    color: #fff;
}

::-ms-input-placeholder {
    color: #fff;
}

button:focus {
    -moz-box-shadow: none !important;
    -webkit-box-shadow: none !important;
    box-shadow: none !important;
    outline-width: 0;
}

.datepicker {
  background-color: #000 !important;
  color: #fff !important;
  border: none;
  padding: 10px !important;
}

.datepicker-dropdown:after {
  border-bottom: 6px solid #000;
}

/* thead tr:nth-child(3) th {
  color: #fff !important;
  font-weight: bold;
  padding-top: 20px;
  padding-bottom: 10px;
}
 */
.dow, .old-day, .day, .new-day {
  width: 40px !important;
  height: 40px !important;
  border-radius: 0px !important;
}

.old-day:hover, .day:hover, .new-day:hover, .month:hover, .year:hover, .decade:hover, .century:hover {
  border-radius: 6px !important;
  background-color: #eee;
  color: #000;
}


.disabled {
  color: #616161 !important;
}

.prev, .next, .datepicker-switch {
  border-radius: 0 !important;
  padding: 20px 10px !important;
  text-transform: uppercase;
  font-size: 20px;
  color: #fff !important;
  opacity: 0.8;
}

.prev:hover, .next:hover, .datepicker-switch:hover {
  background-color: inherit !important;
  opacity: 1;
}

.cell {
  border: 1px solid #BDBDBD;
  margin: 2px;
  cursor: pointer;
}

.cell:hover {
  border: 1px solid #3D5AFE;
}

.cell.select {
  background-color: #3D5AFE;
  color: #fff;
}


.fa-calendar {
  color: #fff;
  font-size: 30px;
  padding-top: 8px;
  padding-left: 5px;
  cursor: pointer;
}


/*달력박스  */
#ui-datepicker-div{
width:330px !important;
background-color: black !important;

}

/*달력 */
.ui-datepicker-calendar{ 
margin-top:20px;
margin-bottom:20px;
background-color: black !important;
width:230px !important;
height:300px !important;
font-size: 16px !important;
font-weight:600 !important;
color: white !important;
text-align: center !important;
margin-left: 50px;

}

.ui-datepicker-week-end{
margin-left: 20px !important;
}
.ui-state-default{
color: white !important;
}
.ui-datepicker-header{
margin-top:20px;
background-color: black !important;
}
.ui-datepicker-other-month,
.ui-datepicker-prev, .ui-datepicker-next .ui-icon-circle-triangle-e, .ui-datepicker-title
.ui-datepicker-year{
background-color: black! important;
color : white!important;

}

.ui-datepicker-year{
text-align: center !important;

}
 .ui-datepicker-prev{
 text-align: left !important;
 margin-left: 30px !important;
 } 
 
 /*달력아이콘  */
 .fa-calendar{
 margin-left: 650px !important;
 margin-top: -47px !important;
 }
 
 .ui-datepicker-next{
 text-align: right !important;
  margin-left: 200px !important;
 }
 
 .ui-datepicker-month{
 color : white!important;
 font-size: 20px!important;
 font-weight:700;
 text-align: center !important;
 margin-left: 100px !important;
 margin-bottom: 30px !important;
 
 }
 


</style>


<div class="row g-3 mb-3 row-deck" id="top" style="margin-left: -100px; margin-right: -100px; margin-top: -20px;">

			<!--1열  -->
			<div class="row align-items-center">



				<div
					class="card-header py-3 d-flex justify-content-between bg-transparent border-bottom-0">
					<%
					Date currentYear = new Date();
					Date currentMonth = new Date();
					Date currentDay = new Date();
					SimpleDateFormat dateFormatYear = new SimpleDateFormat("yyyy");
					SimpleDateFormat dateFormatMonth = new SimpleDateFormat("MM");
					SimpleDateFormat dateFormatDay = new SimpleDateFormat("dd");
					String formattedYear = dateFormatYear.format(currentYear);
					String formattedMonth = dateFormatMonth.format(currentMonth);
					String formattedDay = dateFormatDay.format(currentDay);
					
				
					LocalDate currentDate = LocalDate.now();
					DayOfWeek dayOfWeek = currentDate.getDayOfWeek();
					String formattedDayOfWeek = dayOfWeek.toString();
				    String formatDayOfWeek = dayOfWeek.getDisplayName(TextStyle.SHORT, Locale.US);
					%>
				
					<h6 class="mb-0 fw-bold " style="margin-left: 1347px; margin-bottom: 5px !important;"><br>
				     	<span class="text-primary">DAY &nbsp; </span>
						<span style="color: black">	
						<%=formattedYear%>&nbsp;-
	  			        <%=formattedMonth%>&nbsp;-
						<%=formattedDay%>
						/<%=formatDayOfWeek %>&nbsp;&nbsp;&nbsp;</span>
						<span class="text-primary" style="margin-top:-20px !important; margin-bottom: 25px !important;"><i class="bi bi-clock fs-5"></i></span>
						<span class="text-primary">TIME &nbsp; </span><span id="timeDisplay" class="mb-0 fw-bold"></span>
					</h6>
				
				</div>
 <script>
        function updateTime() {
            var timeDisplay = document.getElementById("timeDisplay");
            var currentTime = new Date();
            var formattedTime = currentTime.toLocaleTimeString([], { timeStyle: 'medium', hour12: true });

            timeDisplay.innerHTML = "<span style='color: black;'>" + formattedTime + "</span>";

            setTimeout(updateTime, 1000); // 1초마다 업데이트
        }

        updateTime(); // 초기 호출
    </script>


				<div
					class="card-header no-bg bg-transparent d-flex align-items-center px-0 justify-content-end flex-wrap" style="margin-top:-20px">

					<div class="d-flex project-tab flex-wrap w-sm-100">
						<ul
							class="nav nav-tabs tab-body-header rounded ms-3 prtab-set w-sm-100"
							role="tablist" style="border-bottom: none;">

						  <li class="nav-item">
							 <a class="nav-link active mb-0 fw-bold"
								data-bs-toggle="tab" href="#list-view" role="tab" id="list-viewBtn"
								style="color: white !important; font-size: 16px;">전체조회</a>
							</li>


							<li class="nav-item"><a class="nav-link mb-0 fw-bold"
								data-bs-toggle="tab" href="#grid-view" role="tab" id="clinicGrid-viewBtn"
								style="color: white !important; font-size: 16px;">외래조회</a></li>


							<li class="nav-item"><a class="nav-link mb-0 fw-bold"
								data-bs-toggle="tab" href="#grid-view2" role="tab" id="examGrid-viewBtn"
								style="color: white !important; font-size: 16px;">검사조회</a></li>


							<li class="nav-item"><a class="nav-link mb-0 fw-bold"
								data-bs-toggle="tab" href="#grid-view3" role="tab" id="ttGrid-viewBtn"
								style="color: white !important; font-size: 16px;">TimeTable</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<!-- Row end  -->
		<!--1열  -->

		<div class="tab-content" style="margin-left: -100px; margin-right: -100px;">
			<!--2열 1탭  -->
			<div class="tab-pane fade show active" id="list-view">
				<div class="row clearfix g-3">
					<!--1탭2열  -->
					<div class="col-lg-4">
						<!--예약조회  -->
						<div class="card  top-color"
							style="margin-right: 5%; height: 120px; margin-top: 25.5px;">

							<div class="card-body">
								<h6 class="mb-0 fw-bold" style="margin-bottom: 10px;">&nbsp;전체예약
									조회</h6>
								<br>
								<form id="allSearchForm" action="rezTimeList.do" method="GET"
									class="row">
									<div class="col">
										<input type="date" id="resveDate" name="resveDate"
											class="form-control"
											style="font-size: 13px !important; width: 150px;" required>
									</div>
									<div class="col">
										<select id="fcltyCode" name="fcltyCode" class="form-select"
											aria-label="진료/검사실 선택"
											style="font-size: 13px !important; width: 150px;" required>
											<option selected value="X">진료과 선택</option>
											<option value="A">호흡기내과</option>
											<option value="B">소화기내과</option>
											<option value="F">내분비내과</option>
											<option value="D">심장내과</option>
											<option value="E">감염내과</option>
											<option value="C">영상의학과</option>
											<option value="G">종합검진센터</option>
											<option value="K">CT실</option>
											<option value="L">MRI실</option>
											<option value="O">임상병리검사실</option>
											<option value="M">초음파실</option>
											<option value="N">내시경실</option>
											<option value="H">일반검사실</option>
										</select>
									</div>
									<div class="col">
										<input type="submit" value="SEARCH" class="allSearchBtn btn btn-primary"
											style="margin-left: 5px; margin-right: 3px; font-size: 13px !important;">
										<c:url value='/rez/rezList.do' var="listURL"></c:url>
										<a class="btn btn-danger"
											style="text-align: right; font-size: 13px !important;"
											href="${listURL}">RESET</a>
									</div>
								</form>


							</div>
							<!--body  -->

						</div>
						<!--card  -->
						<!--예약조회  -->



						<div class="card top-color"
							style="margin-right: 5%; margin-top: 3%; height: 598px;">
							<div class="card-header py-3 d-flex justify-content-between bg-transparent border-bottom-0" style="margin-left: 10px;">
								<h6 class="mb-0 fw-bold">예약환자 상세조회</h6>
							</div>
							 <div class="card-body basic-custome-color" style="margin-left: 20px;">
                                <div class="table-responsive">

								<table class="table" style="width: 480px;">
							
									<tbody class="patientInfo">
									</tbody>
								</table>
								</div>
							</div>
						</div>
					</div>
					<!--col  -->

					<!--1탭1열  -->
					<div class="col-lg-8">
						<div class="card mb-3 top-color" id="overflow"
							style="height: 735px; margin-top: 25px;">
							<div class="card-body" style="height: 400px;">

								<table id="patient-table"
									class="table table-hover align-middle mb-0"
									style="width: 100%; text-align: center;">
									<thead>
										<tr>
											<th>&nbsp;&nbsp;&nbsp;예약관리</th>
											<th>&nbsp;성&nbsp;&nbsp;명</th>
											<th>&nbsp;&nbsp;생년월일</th>
											<th>&nbsp;연락처</th>
											<th>진료일자</th>
											<th>진료시간</th>
											<th>진료과</th>
											<th>담당의</th>
										</tr>
									</thead>
									<tbody>
										<c:set var="rezList" value="${rezList }" />
										<c:if test="${empty rezList }">
											<tr>
												<td colspan="9">조회하신 날짜에 예약 환자가 없습니다.</td>

											</tr>
										</c:if>
										<c:if test="${not empty rezList }">
											<c:forEach items="${rezList }" var="rezList">
												<tr>
													<td>
													<button class="btn-primary rezUpdateBtn" data-bs-toggle="modal" data-bs-target="#draggableModal"
															data-rezcode="${rezList.patntCode}" value="${rezList.resveNum}">
															${rezList.resveNum}</button>
													</td>

													<td>
														<button class="btn-success rezBtn"
															data-time="${rezList.patntCode}">
															${rezList.patntNm}</button>
													</td>
													<td>${rezList.birth}</td>
													<td>${rezList.patntTelno}</td>
													<td>${rezList.convertDate}</td>
													<td>
													<span class="resveTime"data-time="${rezList.resveTime}"></span><span>&nbsp;-</span>
													<span class="resveEndtime"data-endtime="${rezList.resveEndtime}"></span></td>
													<td>${rezList.fcltyNm}</td>
													<td>${rezList.docEmpNm}</td>
												</tr>
											</c:forEach>
										</c:if>
									</tbody>
								</table>
							
							</div>
							<!--cardbody -->
						</div>
						<!--card  -->
					</div>
					<!--col  -->

				</div>
				<!-- Row End -->
			</div>
			<!--tab  -->

			<!--2탭  -->
			<div class="tab-pane fade" id="grid-view">
				<div class="row clearfix g-3">

					<!--2탭1열  -->
					<div class="col-lg-4">
						<!--예약조회  -->
						<div class="card top-color"
							style="margin-right: 5%; height: 120px; margin-top: 25.5px;">

							<div class="card-body">
								<h6 class="mb-0 fw-bold" style="margin-bottom: 10px;">&nbsp;외래예약
									조회</h6>
								<br>
								<form action="rezTimeList.do" method="GET" class="row">
									<div class="col">
										<input type="date" id="clinicResveDate" name="resveDate"
											class="form-control"
											style="font-size: 13px !important; width: 150px;"
											required>
									</div>
									<div class="col">
										<select id="clinicFcltyCode" name="fcltyCode" class="form-select"
											aria-label="진료과 선택"
											style="font-size: 13px !important; width: 150px;"
											required>
											<option selected value="X">진료과 선택</option>
											<option value="A">호흡기내과</option>
											<option value="B">소화기내과</option>
											<option value="F">내분비내과</option>
											<option value="D">심장내과</option>
											<option value="E">감염내과</option>
											<option value="C">영상의학과</option>
											<option value="G">종합검진센터</option>
										</select>
									</div>
									<div class="col">
										<input type="submit" value="SEARCH" class="clinicSearchBtn btn btn-primary"
											style="margin-left: 5px; margin-right: 3px; font-size: 13px !important;">
										
										<button id="clicicResetBtn" class="btn btn-danger"
												style="font-size: 13px !important;">RESET</button>
									</div>
								</form>
							</div>
							<!--cardbody  -->
						</div>
						<!--card  -->


						<!--예약조회  -->

						<div class="card top-color"
							style="margin-right: 5%; margin-top: 3%; height: 598px;">
							<div class="card-header py-3 d-flex justify-content-between bg-transparent border-bottom-0" style="margin-left: 10px;">
								
								<h6 class="mb-0 fw-bold">예약환자 상세조회</h6>
							</div>
							 <div class="card-body basic-custome-color" style="margin-left: 20px;">
                                <div class="table-responsive">

								<table class="table" style="width: 480px;">
									<tbody class="clinicPatientInfo">
									</tbody>
								</table>
								</div>
							</div>
						</div>
					</div>
					<!--col  -->

					<!--2탭1열  -->
					<div class="col-lg-8">
						<div class="card mb-3 top-color"  
							style="height: 735px; margin-top: 25px; overflow: auto;">
							<div class="card-body" style="height: 400px;">

								<table id="myProjectTable"
									class="table table-hover align-middle mb-0"
									style="width: 100%; text-align: center;"">
									<thead>
										<tr>
											<th>&nbsp;&nbsp;&nbsp;예약관리</th>
											<th>&nbsp;성&nbsp;&nbsp;명</th>
											<th>&nbsp;&nbsp;생년월일</th>
											<th>&nbsp;연락처</th>
											<th>진료일자</th>
											<th>진료시간</th>
											<th>진료과</th>
											<th>담당의</th>
										</tr>
									</thead>
									<tbody id="clinicRezList">
									</tbody>
								</table>
							</div>
							<!--cardbody -->
						</div>
						<!--card  -->
					</div>
					<!--col  -->

				</div>
				<!-- Row End -->
			</div>
			<!--2tab  -->

			<!--2탭  -->
			<div class="tab-pane fade" id="grid-view2">
				<div class="row clearfix g-3">

					<!--1탭1열  -->
					<div class="col-lg-4">
						<!--예약조회  -->
						<div class="card  top-color" 
							style="margin-right: 5%; height: 120px; margin-top: 25.5px;">

							<div class="card-body">
								<h6 class="mb-0 fw-bold" style="margin-bottom: 10px;">&nbsp;검사예약
									조회</h6>
								<br>
								<form action="rezTimeList.do" method="GET" class="row">
									<div class="col">
										<input type="date" id="examResveDate" name="resveDate"
											class="form-control"
											style="font-size: 13px !important; width: 150px;"
											required="required">
									</div>
									<div class="col">
										<select id="examFcltyCode" name="fcltyCode" class="form-select"
											aria-label="검사실 선택"
											style="font-size: 13px !important; width: 150px;"
											required="required">
											<option selected value="X">검사실 선택</option>
											<option value="K">CT실</option>
											<option value="L">MRI실</option>
											<option value="O">임상병리검사실</option>
											<option value="M">초음파실</option>
											<option value="N">내시경실</option>
											<option value="H">일반검사실</option>
										</select>
									</div>
									<div class="col">
										<input type="submit" value="SEARCH" class="examSearchBtn btn btn-primary"
											style="margin-left: 5px; margin-right: 3px; font-size: 13px !important;">
										<c:url value='/rez/examRezList.do' var="listURL"></c:url>
											<button id="rezExamResetBtn" class="btn btn-danger"
												style="font-size: 13px !important;">RESET</button>
									</div>
								</form>
							</div>
							<!--cardbody  -->
						</div>
						<!--card  -->


						<!--예약조회  -->

						<div class="card top-color"
							style="margin-right: 5%; margin-top: 3%; height: 598px;">
							<div class="card-header py-3 d-flex justify-content-between bg-transparent border-bottom-0" style="margin-left: 10px;">
								<h6 class="mb-0 fw-bold">예약환자 상세조회</h6>
						</div>
							 <div class="card-body basic-custome-color" style="margin-left: 20px;">
                                <div class="table-responsive">

								<table class="table" style="width: 480px;">
									
									<tbody class="examPatientInfo">
									</tbody>
								</table>
								</div>
							</div>
						</div>
					</div>
					<!--col  -->

					<!--2탭2열  -->
					<div class="col-lg-8">
						<div class="card mb-3 top-color"
							style="height: 735px; margin-top: 25px;"id="overflow3">
							<div class="card-body" style="height: 400px;">

								<table id="myProjectTable2"
									class="table table-hover align-middle mb-0"
									style="width: 100%; text-align: center;">
									<thead>
									<tr>
											<th>&nbsp;&nbsp;&nbsp;예약관리</th>
											<th>&nbsp;성&nbsp;&nbsp;명</th>
											<th>&nbsp;&nbsp;생년월일</th>
											<th>&nbsp;연락처</th>
											<th>진료일자</th>
											<th>진료시간</th>
											<th>진료과</th>
											<th>담당의</th>
										</tr>
									</thead>
									<tbody id="examRezList">

									</tbody>
								</table>
							
							</div>
							<!--cardbody -->
						</div>
						<!--card  -->
					</div>
					<!--col  -->

				</div>
				<!-- Row End -->
			</div>
			<!--2tab  -->



			<!--4탭시작  -->
			<div class="tab-pane fade" id="grid-view3">
				<div class="body d-flex py-lg-3 py-md-2">
				
						<div class="row align-items-center">
							<div class="border-0 mb-4">

								<ul class="nav nav-tabs" id="subTabs" role="tablist">
									<li class="nav-item" role="presentation">
										<button class="nav-link active mb-0 fw-bold"
											id="tab1-tab clinicTimeTab" data-bs-toggle="tab"
											data-bs-target="#tab1" type="button" role="tab"
											aria-controls="tab1" aria-selected="true">진료과</button>
									</li>
									<li class="nav-item" role="presentation">
										<button class="nav-link mb-0 fw-bold"
											id="tab2-tab examTimeTab" data-bs-toggle="tab"
											data-bs-target="#tab2" type="button" role="tab"
											aria-controls="tab2" aria-selected="false">검사실</button>
									</li>
								</ul>
							</div>


						</div>
						<!-- Row end  -->


						<!--4-1 탭 start  -->


						<div class="tab-content">
							<div class="tab-pane fade show active" id="tab1" role="tabpanel"
								aria-labelledby="tab1-tab">

								<div class="row clearfix g-3">
									<div class="col-sm-12">
										<div class="card mb-3 top-color">

											<!--진료과 timeTable 날짜 검색  -->
											<div class="card-body"
												style="width: 746px; margin-bottom: -20px; margin-left: 30px;">
												<div class="col d-flex align-items-center">
													<!-- 추가된 d-flex와 align-items-center -->
													<input type="date" id="clinicTTResveDate" name="resveDate"
														class="form-control"
														style="font-size: 13px !important; width: 150px;" required>
													<button id="clinicTTBtn" class="btn btn-primary"
														style="margin-left: 13px; margin-right: 8px; font-size: 13px !important;">SEARCH</button>

													<button id="clinicResetBtn" class="ttBtn btn btn-danger"
														style="font-size: 13px !important;">TODAY</button>


												</div>
											</div>
											<!--진료과 timeTable 날짜 검색  -->

											<div class="card-body" id="overflow2">
												<div class="schedule" id="clinic">

													<div class="schedule_header">
														<span class="dl">Time</span> <span class="ds">Ti</span>
													</div>

													<!-- week-->
													<div class="schedule_header schedule-sunday">
														<span class="dl">호흡기내과</span> <span class="ds">Su</span>
													</div>
													<div class="schedule_header schedule-monday">
														<span class="dl">소화기내과</span> <span class="ds">M</span>
													</div>
													<div class="schedule_header schedule-tuesday">
														<span class="dl">내분비내과</span> <span class="ds">T</span>
													</div>
													<div class="schedule_header schedule-wednesday">
														<span class="dl">심장내과</span> <span class="ds">W</span>
													</div>
													<div class="schedule_header schedule-thursday">
														<span class="dl">감염내과</span> <span class="ds">Th</span>
													</div>
													<div class="schedule_header schedule-friday">
														<span class="dl">영상의학과</span> <span class="ds">F</span>
													</div>
													<div class="schedule_header schedule-saturday">
														<span class="dl">종합검진센터</span> <span class="ds">Sa</span>
													</div>

													<!-- Time-->

													<div class="schedule_time time-from-seven">07:00 AM</div>
													<div class="schedule_time time-from-eight">08:00 AM</div>
													<div class="schedule_time time-from-nine">09:00 AM</div>
													<div class="schedule_time time-from-ten">10:00 AM</div>

													<div class="schedule_time time-from-eleven">11:00 AM</div>
													<div class="schedule_time time-from-twelve">12:00 PM</div>
													<div class="schedule_time time-from-lunch">13:00 PM</div>
													<div class="schedule_time time-from-fourteen">14:00
														PM</div>

													<div class="schedule_time time-from-fifteen">15:00 PM</div>
													<div class="schedule_time time-from-sixteen">16:00 PM</div>
													<div class="schedule_time time-from-seventeen">17:00
														PM</div>
													<div class="schedule_time time-from-eightteen">18:00
														PM</div>
													<!-- Time-->

													<!--  Grid Rows-->

													<div
														class="grid time-from-seven time-to-eight schedule-row-from-sunday schedule-row-to-saturday"></div>
													<div
														class="grid time-from-eight time-to-nine schedule-row-from-sunday schedule-row-to-saturday"></div>
													<div
														class="grid time-from-nine time-to-ten schedule-row-from-sunday schedule-row-to-saturday"></div>

													<div
														class="grid time-from-ten time-to-eleven schedule-row-from-sunday schedule-row-to-saturday"></div>
													<div
														class="grid time-from-eleven time-to-twelve schedule-row-from-sunday schedule-row-to-saturday"></div>
													<div
														class="grid time-from-twelve time-to-lunch schedule-row-from-sunday schedule-row-to-saturday"></div>
													<div
														class="grid time-from-lunch time-to-fourteen schedule-row-from-sunday schedule-row-to-saturday"></div>

													<div
														class="grid time-from-fourteen time-to-fifteen schedule-row-from-sunday schedule-row-to-saturday"></div>
													<div
														class="grid time-from-fifteen time-to-sixteen schedule-row-from-sunday schedule-row-to-saturday"></div>
													<div
														class="grid time-from-sixteen time-to-seventeen schedule-row-from-sunday schedule-row-to-saturday"></div>
													<div
														class="grid time-from-seventeen time-to-eightteen schedule-row-from-sunday schedule-row-to-saturday"></div>
													<div
														class="grid grid-last time-from-eightteen time-to-eightteen schedule-row-from-sunday schedule-row-to-saturday"></div>

													<!--   ./Grid Rows-->



													<div
														class="grid schedule-sunday time-from-seven time-to-eightteen"></div>
													<div
														class="grid grid-last schedule-sunday time-from-eightteen time-to-eightteen"></div>
													<div
														class="grid schedule-monday time-from-seven time-to-eightteen"></div>
													<div
														class="grid grid-last schedule-monday time-from-eightteen time-to-eightteen"></div>

													<div
														class="grid schedule-tuesday time-from-seven time-to-eightteen"></div>
													<div
														class="grid grid-last schedule-tuesday time-from-eightteen time-to-eightteen"></div>

													<div
														class="grid schedule-wednesday time-from-seven time-to-eightteen"></div>
													<div
														class="grid grid-last schedule-wednesday time-from-eightteen time-to-eightteen"></div>

													<div
														class="grid schedule-thursday time-from-seven time-to-eightteen"></div>
													<div
														class="grid grid-last schedule-thursday time-from-eightteen time-to-eightteen"></div>

													<div
														class="grid schedule-friday time-from-seven time-to-eightteen"></div>
													<div
														class="grid grid-last schedule-friday time-from-eightteen time-to-eightteen"></div>

													<div
														class="grid schedule-saturday time-from-seven time-to-eightteen"></div>
													<div
														class="grid grid-last schedule-saturday time-from-eightteen time-to-eightteen"></div>

												</div>
											</div>
										</div>
									</div>
								</div>
								<!-- Row End -->
							</div>
						</div>
						<!--시간표 끝  -->

					</div>
					<!--3-1SHOW TAB END  -->


					<div class="tab-pane fade" id="tab2" role="tabpanel"
						aria-labelledby="tab2-tab">
						<!-- Tab 2 내용 -->

						<div class="row clearfix g-3">
							<div class="col-sm-12">
								<div class="card mb-3">
									<!--검사실 timeTable 날짜 검색  -->
									<div class="card-body"
										style="width: 400px; margin-bottom: -20px; margin-left: 30px;">
										<div class="col d-flex align-items-center">
											<!-- 추가된 d-flex와 align-items-center -->
											<input type="date" id="examTTResveDate" name="resveDate"
												class="form-control"
												style="font-size: 13px !important; width: 150px;" required>
											<button id="examTTBtn" class="btn btn-primary"
												style="margin-left: 13px; margin-right: 8px; font-size: 13px !important;">SEARCH</button>
											<button id="examResetBtn" class="ttBtn btn btn-danger"
												style="font-size: 13px !important;">TODAY</button>
										</div>
									</div>
									<!--검사실 timeTable 날짜 검색  -->
									<div class="card-body overflow-auto">
										<div class="schedule" id="exam">

											<div class="schedule_header">
												<span class="dl">Time</span> <span class="ds">Ti</span>
											</div>

											<!-- week-->
											<div class="schedule_header schedule-sunday">
												<span class="dl">CT실</span> <span class="ds">Su</span>
											</div>
											<div class="schedule_header schedule-monday">
												<span class="dl">MRI실</span> <span class="ds">M</span>
											</div>
											<div class="schedule_header schedule-tuesday">
												<span class="dl">임상병리검사실</span> <span class="ds">T</span>
											</div>
											<div class="schedule_header schedule-wednesday">
												<span class="dl">초음파실</span> <span class="ds">W</span>
											</div>
											<div class="schedule_header schedule-thursday">
												<span class="dl">내시경실</span> <span class="ds">Th</span>
											</div>
											<div class="schedule_header schedule-friday">
												<span class="dl">일반검사실</span> <span class="ds">F</span>
											</div>
											<div class="schedule_header schedule-saturday">
												<span class="dl">비고</span> <span class="ds">Sa</span>
											</div>

											<!-- Time-->

											<div class="schedule_time time-from-seven">07:00 AM</div>
											<div class="schedule_time time-from-eight">08:00 AM</div>
											<div class="schedule_time time-from-nine">09:00 AM</div>
											<div class="schedule_time time-from-ten">10:00 AM</div>

											<div class="schedule_time time-from-eleven">11:00 AM</div>
											<div class="schedule_time time-from-twelve">12:00 PM</div>
											<div class="schedule_time time-from-lunch">13:00 PM</div>
											<div class="schedule_time time-from-fourteen">14:00 PM</div>

											<div class="schedule_time time-from-fifteen">15:00 PM</div>
											<div class="schedule_time time-from-sixteen">16:00 PM</div>
											<div class="schedule_time time-from-seventeen">17:00 PM</div>
											<div class="schedule_time time-from-eightteen">18:00 PM</div>
											<!-- Time-->

											<!--  Grid Rows-->

											<div
												class="grid time-from-seven time-to-eight schedule-row-from-sunday schedule-row-to-saturday"></div>
											<div
												class="grid time-from-eight time-to-nine schedule-row-from-sunday schedule-row-to-saturday"></div>
											<div
												class="grid time-from-nine time-to-ten schedule-row-from-sunday schedule-row-to-saturday"></div>

											<div
												class="grid time-from-ten time-to-eleven schedule-row-from-sunday schedule-row-to-saturday"></div>
											<div
												class="grid time-from-eleven time-to-twelve schedule-row-from-sunday schedule-row-to-saturday"></div>
											<div
												class="grid time-from-twelve time-to-lunch schedule-row-from-sunday schedule-row-to-saturday"></div>
											<div
												class="grid time-from-lunch time-to-fourteen schedule-row-from-sunday schedule-row-to-saturday"></div>

											<div
												class="grid time-from-fourteen time-to-fifteen schedule-row-from-sunday schedule-row-to-saturday"></div>
											<div
												class="grid time-from-fifteen time-to-sixteen schedule-row-from-sunday schedule-row-to-saturday"></div>
											<div
												class="grid time-from-sixteen time-to-seventeen schedule-row-from-sunday schedule-row-to-saturday"></div>
											<div
												class="grid time-from-seventeen time-to-eightteen schedule-row-from-sunday schedule-row-to-saturday"></div>
											<div
												class="grid grid-last time-from-eightteen time-to-eightteen schedule-row-from-sunday schedule-row-to-saturday"></div>

											<!--   ./Grid Rows-->



											<div
												class="grid schedule-sunday time-from-seven time-to-eightteen"></div>
											<div
												class="grid grid-last schedule-sunday time-from-eightteen time-to-eightteen"></div>
											<div
												class="grid schedule-monday time-from-seven time-to-eightteen"></div>
											<div
												class="grid grid-last schedule-monday time-from-eightteen time-to-eightteen"></div>

											<div
												class="grid schedule-tuesday time-from-seven time-to-eightteen"></div>
											<div
												class="grid grid-last schedule-tuesday time-from-eightteen time-to-eightteen"></div>

											<div
												class="grid schedule-wednesday time-from-seven time-to-eightteen"></div>
											<div
												class="grid grid-last schedule-wednesday time-from-eightteen time-to-eightteen"></div>

											<div
												class="grid schedule-thursday time-from-seven time-to-eightteen"></div>
											<div
												class="grid grid-last schedule-thursday time-from-eightteen time-to-eightteen"></div>

											<div
												class="grid schedule-friday time-from-seven time-to-eightteen"></div>
											<div
												class="grid grid-last schedule-friday time-from-eightteen time-to-eightteen"></div>

											<div
												class="grid schedule-saturday time-from-seven time-to-eightteen"></div>
											<div
												class="grid grid-last schedule-saturday time-from-eightteen time-to-eightteen"></div>

										</div>
									</div>
								</div>
							</div>
						</div>
						<!-- clearfix Row End -->



					</div>
					<!--3-1,2탭 종료-->

				</div>
				<!--BODY  -->
			</div>
	









	   <!-- 예약변경 모달-->
        <div class="modal fade" id="draggableModal" tabindex="-1"  aria-hidden="true">
     <div class="modal-dialog modal-dialog-right modal-xl">
            
            
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title  fw-bold" id="depaddLabel">취소/변경</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                 <h5 class="modal-title  fw-bold" id="depaddLabel">예약취소</h5>
                
                 <div class="mb-3">
                        <label  class="form-label rezUpdateLabel">기존예약정보</label>
                        <div id="rezInfoDiv">
                        
                        </div>
                      
                        <button type="button" class="btn btn-danger rezDeleteBtn"
                        data-bs-dismiss="modal"  style="margin-left: 184px; margin-top: 15px;">예약취소</button>
                    </div>
                    <div class="deadline-form">
                        <form id="rezUpdateForm">
                            <div class="row g-3 mb-3">
                              <div class="col-sm-12">
                                    <h5 class="modal-title  fw-bold" id="depaddLabel" >예약변경</h5>
                                    
                           
                                 
<!--datePicker  -->

  <div class="container-fluid px-0 px-sm-0 mx-auto">
  <div class="row justify-content-center mx-0">
    <div class="col-lg-12">
      <div class="card card-dp border-0">
          <div class="card-header bg-dark">
            <div class="mx-0 mb-0 row justify-content-sm-center justify-content-start px-1">
              <input type="text" id="dp1" class="datepicker" placeholder="Pick Date" name="date" readonly><span class="fa fa-calendar"></span>
            </div>
          </div>
          <div class="card-body">
            <div class="row text-center mx-0">
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">7:00</div></div>
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">8:00</div></div>
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">9:00</div></div>
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">10:00</div></div>
            </div>
            <div class="row text-center mx-0">
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">11:00</div></div>
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">12:00</div></div>
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">13:00</div></div>
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">14:00</div></div>
            </div>
            <div class="row text-center mx-0">
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">15:00</div></div>
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">16:00</div></div>
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">17:00</div></div>
              <div class="col-md-3 col-4 my-1 px-2"><div class="cell py-1">18:00</div></div>
            </div>
          </div>
      </div>
    </div>
  </div>
</div>
  <!--datePicker  -->             
                              
                              



                              
                              
                              
                <!--               
                 
                          <label  class="form-label rezUpdateLabel">예약시간</label>
                                <select class="form-select" aria-label="Default select example">
                                    <option selected>시간선택</option>
                                    <option value="0700" data-endtime="0800">07:00</option>
                                    <option value="0800" data-endtime="0900">08:00</option>
                                    <option value="0900" data-endtime="0800">09:00</option>
                                    <option value="1000" data-endtime="0800">10:00</option>
                                    <option value="1100" data-endtime="0800">11:00</option>
                                    <option value="1200" data-endtime="0800">12:00</option>
                                    <option value="1300" data-endtime="0800">13:00</option>
                                    <option value="1400" data-endtime="0800">14:00</option>
                                    <option value="1500" data-endtime="0800">15:00</option>
                                    <option value="1600" data-endtime="0800">16:00</option>
                                    <option value="1700" data-endtime="0800">17:00</option>
                                    <option value="1800" data-endtime="0800">18:00</option>
                                </select>
                           -->
                          
                           </div>
                              <div class="col-md-12">
                                <label  class="form-label rezUpdateLabel">외래진료과</label>
                                <select id="updateFcltyCode" class="form-select" aria-label="Default select example">
                                    <option selected value="X">진료과 선택</option>
											<option value="A">(진료)호흡기내과</option>
											<option value="B">(진료)소화기내과</option>
											<option value="F">(진료)내분비내과</option>
											<option value="D">(진료)심장내과</option>
											<option value="E">(진료)감염내과</option>
											<option value="C">(진료/검사)영상의학과</option>
											<option value="G">(진료/검사)종합검진센터</option>
											<option value="K">(검사)CT실</option>
								  			<option value="L">(검사)MRI실</option>
								  			<option value="O">(검사)임상병리검사실</option>
								 			<option value="M">(검사)초음파실</option>
								  			<option value="N">(검사)내시경실</option>
								  			<option value="H">(검사)일반검사실</option>
                                </select>
                              </div>
                              <div class="col-md-12">
                                <label  class="form-label rezUpdateLabel">검사과</label>
                                <select  id="updateExamFcltyCode" class="form-select" aria-label="Default select example">
                                  <option selected value="X">검사실 선택</option>
								  <option value="K">CT실</option>
								  <option value="L">MRI실</option>
								  <option value="O">임상병리검사실</option>
								  <option value="M">초음파실</option>
								  <option value="N">내시경실</option>
								  <option value="H">일반검사실</option>
                                </select>
                              </div>
                             
                            </div>
                        </form>
                              <button type="button" class="btn btn-primary" style="margin-left: 184px;">예약변경</button>
                        
                    </div>
                    
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary rezUpdateBtn" data-bs-dismiss="modal">닫기</button>
                  
                </div>
            </div>
            </div>
        </div>


<!-- Plugin Js-->
<script src="<%=request.getContextPath()%>/resources/dist/assets/bundles/dataTables.bundle.js"></script>
	
<script src="https://cdn.jsdelivr.net/npm/sweetSwal.fire2@9"></script>

<script>


	$('.datepicker').datepicker({
	    format: 'dd-mm-yyyy',
	    autoclose: true,
	    startDate: '0d'
	});

	$('.cell').click(function(){
	    $('.cell').removeClass('select');
	    $(this).addClass('select');
	});
	
	
	
	
	$(function() {
		  $("#datepicker").datepicker();
		});
	
	$(function() {
		  $("#datepicker").datepicker({
		    onSelect: function(dateText) {
		      // 선택한 날짜를 처리하는 코드를 여기에 추가
		      console.log("선택한 날짜:", dateText);
		    }
		  });
		});


</script>

<script>
  // 날짜 선택 이벤트 핸들러
  $('#dp1').datepicker({
    onSelect: function (formattedDate, date, inst) {
      // 선택한 날짜에 대한 처리를 수행합니다.
      // 여기에서는 선택한 날짜를 yyyy-mm-dd 형식으로 가져왔다고 가정합니다.
      var selectedDate = formattedDate;

      // 예약 시간 select 요소를 찾습니다.
      var $select = $('.form-select');

      // 선택한 날짜에 따라 option 값을 변경합니다.
      $select.find('option').each(function () {
        var $option = $(this);
        var startTime = $option.val();
        var endTime = $option.data('endtime');

        // 새로운 값을 설정
        // 여기에서는 선택한 날짜와 startTime을 조합하여 새로운 값을 설정
        var newValue = selectedDate + ' ' + startTime;

        // option의 값을 변경
        $option.val(newValue);

        // 변경된 값을 적용
        $select.val(newValue);
      });
    },
  });
</script>

<script>
 
    $("#draggableModal").draggable({
      handle: ".modal-header" // You can specify the handle for dragging (e.g., modal header)
    });
  
</script>


<script>
	$(document).ready(function() { /* noTouch */

		//전체조회페이지에서 검색버튼 클릭시 날짜/진료과 미선택 시 알림창
		$(document).on("click", ".allSearchBtn", function() {
			var selectedDate = $("#resveDate").val(); // 선택된 날짜 가져오기 (YYYY-MM-DD 형식)
			var selectedFcltyCode = $("#fcltyCode").val(); // 선택된 진료과
			console.log("selectedFcltyCode",selectedFcltyCode);
			if(selectedFcltyCode==="X") {
				Swal.fire({
					  text: "진료과를 선택하세요",
					  confirmButtonText: "확인"
					});
				 event.preventDefault(); // 폼 제출 막기
			        return; // 중단
			}
			
			if(selectedDate==="") {
				Swal.fire('조회날짜를 선택하세요.');
				 event.preventDefault(); // 폼 제출 막기
			        return; // 중단
			}
			
		});
		
	    var thisResveNum='';

		//예약번호 클릭 시 예약변경/취소 모달창에 기존 예약정보 출력
		$(document).on("click", ".rezUpdateBtn", function() {
			var patntCode = $(this).data("rezcode");
			var resveNum = $(this).attr("value"); // 선택된 진료과
			thisResveNum = resveNum;
			
			$.getJSON("<c:url value='/rez/selectRez.do' />",{resveNum : resveNum}).done(function(resp) {
				var rez = resp[0];
				var patntNm = resp[0].patntNm;
				var fcltyNm = resp[0].fcltyNm;
				var fresveDate = resp[0].fresveDate;
				var fresveTime = resp[0].fresveTime;
				var info = patntNm+"님 예약정보 >> (일자) " +fresveDate+", (시간) "+fresveTime+", (진료과)"+fcltyNm;
				
				if(resp===null){

					Toast.fire({
		    		    icon: 'error',
		    		    title: '선택한 예약번호의 정보가 없습니다.'
		    		});
	        	}else{
	        		//모달창에 환자 정보 뿌리기
	        	
	        		$("#rezInfoDiv").text(info);
	        	}
		
});/*getJson  */

});/*docu  */

		//예약 취소/변경 모달창에서 예약 취소하기
	$(document).on("click", ".rezDeleteBtn", function() {
			
			Swal.fire({
				   text:'예약을 삭제하시겠습니까?',
				   icon: 'warning',
				   
				   showCancelButton: true, // cancel버튼 보이기. 기본은 원래 없음
				   confirmButtonColor: '#3085d6', // confrim 버튼 색깔 지정
				   cancelButtonColor: '#d33', // cancel 버튼 색깔 지정
				   confirmButtonText: '삭제', // confirm 버튼 텍스트 지정
				   cancelButtonText: '취소', // cancel 버튼 텍스트 지정
				   
				   reverseButtons: true, // 버튼 순서 거꾸로
				   
				}).then(result => { 
				   if (result.isConfirmed) { // 만약 모달창에서 confirm 버튼을 눌렀다면
			
						var resveNum = thisResveNum;
				        console.log("리저브....",resveNum );
			
			  var viewURL = "<c:url value='/rez/deleteRez.do' />";
			    viewURL += "?resveNum=" + resveNum;
			    console.log("viewURL", viewURL);

		    $.ajax({
		        url: viewURL,
		        success: function(resp) {
		        	var resveDate=resp;
		        	 console.log(resp);
		        	if(resp!==null){
		        	
		        	Toast.fire({
		    		    icon: 'success',
		    		    title: '예약이 취소되었습니다.'
		    		 });
		        	
		        	   var info="예약정보가 없습니다."
			 			$("#rezInfoDiv").empty();
				        $("#rezInfoDiv").text(info);
		        	
				        console.log("1");
		        	}
		        	  console.log("2");
		        }
		      
		        	
		    }); /*ajax  */
		    deleteRezAfterLoadClinicTimeTable(resveDate);
		        	  console.log("4");

	     }
	 });

});

				
			
	
	
	

		//두번째탭 외래예약조회 페이지에서 검색버튼 클릭시 날짜/진료과 미선택 시 알림창
		$(document).on("click", ".clinicSearchBtn", function() {
			var selectedDate = $("#clinicResveDate").val(); // 선택된 날짜 가져오기 (YYYY-MM-DD 형식)
			var selectedFcltyCode = $("#clinicFcltyCode").val(); // 선택된 진료과
			console.log("selectedFcltyCode",selectedFcltyCode);
			if(selectedFcltyCode==="X") {
				Swal.fire('진료과를 선택하세요');
				 event.preventDefault(); // 폼 제출 막기
			        return; // 중단
			}
			
			if(selectedDate==="") {
				Swal.fire('조회날짜를 선택하세요');
				 event.preventDefault(); // 폼 제출 막기
			        return; // 중단
			}
			
		});
	

		//세번째탭 검사예약조회 페이지에서 검색버튼 클릭시 날짜/진료과 미선택 시 알림창
		$(document).on("click", ".examSearchBtn", function() {
			var selectedDate = $("#examResveDate").val(); // 선택된 날짜 가져오기 (YYYY-MM-DD 형식)
			var selectedFcltyCode = $("#examFcltyCode").val(); // 선택된 진료과
			console.log("selectedFcltyCode",selectedFcltyCode);
			if(selectedFcltyCode==="X") {
				Swal.fire('검사실을 선택하세요');
				 event.preventDefault(); // 폼 제출 막기
			        return; // 중단
			}
			
			if(selectedDate==="") {
				Swal.fire('조회날짜를 선택하세요');
				 event.preventDefault(); // 폼 제출 막기
			        return; // 중단
			}
			
		});
		
		
	
		
		   defautltPatntSearchView();
		     //(첫번째탭) 전체조회탭에서 환자선택시 환자예약 상세조회 테이블 기본값
		    
 			function defautltPatntSearchView() {
 				
 				
 				var tbody = $(".patientInfo");
 	 		
 				var info = [" ", " "," "," "," "," "," "," "," "," "," ",];
 				
  			     var firstRow = tbody.eq(0);
			     var secondRow = tbody.eq(1);
			     var thirdRow = tbody.eq(2);
			     var fourthRow = tbody.eq(3);
			     var fifthRow = tbody.eq(4);
			     var sixRow = tbody.eq(5);
			     var sevenRow = tbody.eq(6);
			     var eightRow = tbody.eq(7);
			     var nineRow = tbody.eq(8);
			     var tenRow = tbody.eq(9);
			     
			     
			     var firstRow = $("<tr>").append(
			    		    $("<th>").html("성명"),
			    		    $("<td>").html(info[1])
			    		);
			    		tbody.append(firstRow);

			    		var secondRow = $("<tr>").append(
			    		    $("<th>").html("식별코드"),
			    		    $("<td>").html(info[1])
			    		);
			    		tbody.append(secondRow);
			    		
			    		
			    		var thirdRow = $("<tr>").append(
				    		    $("<th>").html("주민번호"),
				    		    $("<td>").html(info[1])
				    		);
				    		tbody.append(thirdRow);
					
				    	var fourRow = $("<tr>").append(
				    				$("<th>").html("연&nbsp;&nbsp;락&nbsp;&nbsp;처"),
				    				 $("<td>").html(info[1])
					    		);
					    		tbody.append(fourRow);
			
						
					    var fifthRow = $("<tr>").append(
								$("<th>").html("이&nbsp;&nbsp;메&nbsp;&nbsp;일"),
								 $("<td>").html(info[1])
						    		);
						    		tbody.append(fifthRow);

						var sixRow = $("<tr>").append(
								$("<th>").html("주&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;소"),
								 $("<td>").html(info[1])
								);
								tbody.append(sixRow);
						
						var sevenRow = $("<tr>").append(
								$("<th>").html("최초등록일"),
								 $("<td>").html(info[1])
							);
							tbody.append(sevenRow);
							
						var eightRow = $("<tr>").append(	
								$("<th>").html("다음진료일"),
								 $("<td>").html(info[1])
							);
						     tbody.append(eightRow);
						     
							var nineRow = $("<tr>").append(	
								$("<th>").html("담&nbsp;당&nbsp;과"),
								 $("<td>").html(info[1])
							);
						     tbody.append(nineRow);
						
							var tenRow = $("<tr>").append(	
								$("<th>").html("신장/체중"),
								 $("<td>").html(info[1])
									
							);

						 tbody.append(tenRow);
						 
						 
						  isInitialExecution = false; // 최초 실행 이후로 표시를 변경
			}
			
				
		
		
		function defautltPatntSearchView1(tbody, info) {
		
   			     var firstRow = tbody.eq(0);
			     var secondRow = tbody.eq(1);
			     var thirdRow = tbody.eq(2);
			     var fourthRow = tbody.eq(3);
			     var fifthRow = tbody.eq(4);
			     var sixRow = tbody.eq(5);
			     var sevenRow = tbody.eq(6);
			     var eightRow = tbody.eq(7);
			     var nineRow = tbody.eq(8);
			     var tenRow = tbody.eq(9);
			     
			     
			     var firstRow = $("<tr>").append(
			    		    $("<th>").html("성명"),
			    		    $("<td>").html(info[1])
			    		);
			    		tbody.append(firstRow);

			    		var secondRow = $("<tr>").append(
			    		    $("<th>").html("식별코드"),
			    		    $("<td>").html(info[1])
			    		);
			    		tbody.append(secondRow);
			    		
			    		
			    		var thirdRow = $("<tr>").append(
				    		    $("<th>").html("주민번호"),
				    		    $("<td>").html(info[1])
				    		);
				    		tbody.append(thirdRow);
					
				    	var fourRow = $("<tr>").append(
				    				$("<th>").html("연&nbsp;&nbsp;락&nbsp;&nbsp;처"),
				    				 $("<td>").html(info[1])
					    		);
					    		tbody.append(fourRow);
			
						
					    var fifthRow = $("<tr>").append(

								$("<th>").html("이&nbsp;&nbsp;메&nbsp;&nbsp;일"),
								 $("<td>").html(info[1])
						    		);
						    		tbody.append(fifthRow);

						    		var sixRow = $("<tr>").append(
											$("<th>").html("주&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;소"),
											 $("<td>").html(info[1])
											);
											tbody.append(sixRow);
									
									var sevenRow = $("<tr>").append(
											$("<th>").html("최초등록일"),
											 $("<td>").html(info[1])
										);
										tbody.append(sevenRow);
										
									var eightRow = $("<tr>").append(	
											$("<th>").html("다음진료일"),
											 $("<td>").html(info[1])
										);
									     tbody.append(eightRow);
									     
										var nineRow = $("<tr>").append(	
											$("<th>").html("담&nbsp;당&nbsp;과"),
											 $("<td>").html(info[1])
										);
									     tbody.append(nineRow);
						
							var tenRow = $("<tr>").append(	
								$("<th>").html("신장/체중"),
								 $("<td>").html(info[1])
									
							);

						 tbody.append(tenRow);
			}
			
				
		
		//(첫번째탭) 전체조회탭에서 환자선택시 환자예약 상세조회 테이블 기본값
		
			function defautltPatntSearchView2(tbody, info) {
			
   			     var firstRow = tbody.eq(0);
			     var secondRow = tbody.eq(1);
			     var thirdRow = tbody.eq(2);
			     var fourthRow = tbody.eq(3);
			     var fifthRow = tbody.eq(4);
			     var sixRow = tbody.eq(5);
			     var sevenRow = tbody.eq(6);
			     var eightRow = tbody.eq(7);
			     var nineRow = tbody.eq(8);
			     var tenRow = tbody.eq(9);
			     
			     
			     var firstRow = $("<tr>").append(
			    		    $("<th>").html("성명"),
			    		    $("<td>").html(info[1])
			    		);
			    		tbody.append(firstRow);

			    		var secondRow = $("<tr>").append(
			    		    $("<th>").html("식별코드"),
			    		    $("<td>").html(info[1])
			    		);
			    		tbody.append(secondRow);
			    		
			    		
			    		var thirdRow = $("<tr>").append(
				    		    $("<th>").html("주민번호"),
				    		    $("<td>").html(info[1])
				    		);
				    		tbody.append(thirdRow);
					
				    	var fourRow = $("<tr>").append(
				    				$("<th>").html("연&nbsp;&nbsp;락&nbsp;&nbsp;처"),
				    				 $("<td>").html(info[1])
					    		);
					    		tbody.append(fourRow);
			
						
					    var fifthRow = $("<tr>").append(

								$("<th>").html("이&nbsp;&nbsp;메&nbsp;&nbsp;일"),
								 $("<td>").html(info[1])
						    		);
						    		tbody.append(fifthRow);

						    		var sixRow = $("<tr>").append(
											$("<th>").html("주&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;소"),
											 $("<td>").html(info[1])
											);
											tbody.append(sixRow);
									
									var sevenRow = $("<tr>").append(
											$("<th>").html("최초등록일"),
											 $("<td>").html(info[1])
										);
										tbody.append(sevenRow);
										
									var eightRow = $("<tr>").append(	
											$("<th>").html("다음진료일"),
											 $("<td>").html(info[1])
										);
									     tbody.append(eightRow);
									     
										var nineRow = $("<tr>").append(	
											$("<th>").html("담&nbsp;당&nbsp;과"),
											 $("<td>").html(info[1])
										);
									     tbody.append(nineRow);
						
							var tenRow = $("<tr>").append(	
								$("<th>").html("신장/체중"),
								 $("<td>").html(info[1])
									
							);

						 tbody.append(tenRow);
			}
		
				
		
		//(첫번째탭) 전체조회탭에서 환자선택시 환자예약 상세조회 테이블 기본값
		
			function defautltPatntSearchView3(tbody, info) {
			
   			     var firstRow = tbody.eq(0);
			     var secondRow = tbody.eq(1);
			     var thirdRow = tbody.eq(2);
			     var fourthRow = tbody.eq(3);
			     var fifthRow = tbody.eq(4);
			     var sixRow = tbody.eq(5);
			     var sevenRow = tbody.eq(6);
			     var eightRow = tbody.eq(7);
			     var nineRow = tbody.eq(8);
			     var tenRow = tbody.eq(9);
			     
			     
			     var firstRow = $("<tr>").append(
			    		    $("<th>").html("성명"),
			    		    $("<td>").html(info[1])
			    		);
			    		tbody.append(firstRow);

			    		var secondRow = $("<tr>").append(
			    		    $("<th>").html("식별코드"),
			    		    $("<td>").html(info[1])
			    		);
			    		tbody.append(secondRow);
			    		
			    		
			    		var thirdRow = $("<tr>").append(
				    		    $("<th>").html("주민번호"),
				    		    $("<td>").html(info[1])
				    		);
				    		tbody.append(thirdRow);
					
				    	var fourRow = $("<tr>").append(
				    				$("<th>").html("연&nbsp;&nbsp;락&nbsp;&nbsp;처"),
				    				 $("<td>").html(info[1])
					    		);
					    		tbody.append(fourRow);
			
						
					    var fifthRow = $("<tr>").append(

								$("<th>").html("이&nbsp;&nbsp;메&nbsp;&nbsp;일"),
								 $("<td>").html(info[1])
						    		);
						    		tbody.append(fifthRow);

						    		var sixRow = $("<tr>").append(
											$("<th>").html("주&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;소"),
											 $("<td>").html(info[1])
											);
											tbody.append(sixRow);
									
									var sevenRow = $("<tr>").append(
											$("<th>").html("최초등록일"),
											 $("<td>").html(info[1])
										);
										tbody.append(sevenRow);
										
									var eightRow = $("<tr>").append(	
											$("<th>").html("다음진료일"),
											 $("<td>").html(info[1])
										);
									     tbody.append(eightRow);
									     
										var nineRow = $("<tr>").append(	
											$("<th>").html("담&nbsp;당&nbsp;과"),
											 $("<td>").html(info[1])
										);
									     tbody.append(nineRow);
						
							var tenRow = $("<tr>").append(	
								$("<th>").html("신장/체중"),
								 $("<td>").html(info[1])
									
							);

						 tbody.append(tenRow);
			}
			
				
	
		//(첫번째탭) 전체조회탭에서 환자선택시 환자예약 상세조회 테이블 기본값
		
		
		
		
		//(첫번째탭) 전체조회탭에서 환자선택시 상세조회 테이블
		$(document).on("click", ".rezBtn", function() {

			var patntCode = $(this).data("time");
			console.log(patntCode);

			$.getJSON("<c:url value='/rez/rezPatntInfo.do' />", {patntCode : patntCode}).done(function(resp) {

				console.log(resp);
				var info = resp[0];
				var tbody = $(".patientInfo");
				tbody.empty();
				
				patntSearchView(tbody, info);
				
			}); /*getJson  */

		});/*documentClick  */
		
/*첫번째탭 환자상세정보검색 end  */
		



		
//(두번째탭) 외래진료 전체예약리스트 조회 

	$.getJSON("<c:url value='/rez/clinicRezList.do' />").done(function(resp) {
		console.log(resp);

		var info = resp;
		var tbody = $("#clinicRezList");
		tbody.empty();
		
		
		if (resp.length > 0) {
			
			$(resp).each(function(idx, info) {
             // info.resveTime을 네 자리 문자열로 받아서 시간 형식으로 변경
			var formattedTime = info.resveTime.substr(0, 2)
				+ ":" + info.resveTime.substr(2, 2);
			
			var formattedEndtime = info.resveTime.substr(0, 2)+ ":"+ info.resveEndtime.substr(2, 2);
			console.log("포맷타임",formattedEndtime);
			let tr = $("<tr>").append(
					$("<td>").html(info.resveNum),
					$("<td>").html(
							$("<button class='btn-success clinicRezBtn'></button>").attr("data-pcode",info.patntCode)
							.text(info.patntNm).click(
							function() {
							var patntCode = $(this).data("pcode");
							})),
					$("<td>").html(info.birth),
					$("<td>").html(info.patntTelno),
					$("<td>").html(info.convertDate),
				    $("<td>").html(formattedTime+"-"+formattedEndtime),
 					$("<td>").html(info.fcltyNm),
					$("<td>").html(info.docEmpNm));
					
					tbody.append(tr);
											
			});/*$(resp).each(function(idx, info)  */
					
	} else {
		tbody.append($("<tr>").html(
		$("<td colspan='9'>").html("외래진료 예약 정보가 존재하지 않습니다.")));
						
	       }
					
	}); /*getJson  */
	
/*2번째 외래진료 목록 가져오기 end  */
	
	
//(세번째탭) 검사실 전체예약리스트 조회 

	$.getJSON("<c:url value='/rez/examRezList.do' />").done(function(resp) {
		console.log(resp);

		var info = resp;
		var tbody = $("#examRezList");
		tbody.empty();

		if (resp.length > 0) { 
			$(resp).each(function(idx, info) {

				// info.resveTime을 네 자리 문자열로 받아서 시간 형식으로 변경
					var formattedTime1 = info.resveTime.substr(0, 2)
														+ ":"
														+ info.resveTime
																.substr(2, 2);
					var formattedEndtime2 = info.resveEndTime.substr(0, 2)
														+ ":"
														+ info.resveEndtime
																.substr(2, 2);

												let tr = $("<tr>")
														.append(
																$("<td>")
																		.html(
																				info.resveNum),
																$("<td>").html($("<button class='btn-success examRezBtn'></button>")
																						.attr("data-ecode", info.patntCode).text(info.patntNm).click(function() {
																							var patntCode = $(this).data("ecode");
																								})),
																$("<td>")
																		.html(
																				info.patntTelno),
																 $("<td>")
																		.html(
																				info.birth), 
																$("<td>")
																		.html(
																				info.convertDate),
																$("<td>")
																		.html(
																				formattedTime1+"-"+formattedEndtime2),
															
																$("<td>")
																		.html(
																				info.fcltyNm),
																$("<td>")
																		.html(
																				info.docEmpNm));
												tbody.append(tr);
											});
		} else {
							tbody.append($("<tr>").html(
									$("<td colspan='9'>").html(
											"검사 예약 정보가 존재하지 않습니다.")));
		}
	
	}); /*getJson  */

	/* 3번째 탭 검사 예약 조회 탭 종료 */
	
	
	//2번째 탭 진료과 환자선택시 상세조회 테이블
	$(document).on("click",".clinicRezBtn", function() {
		var patntCode = $(this).data("pcode");
	    console.log(patntCode);

		$.getJSON("<c:url value='/rez/rezPatntInfo.do' />",{patntCode : patntCode}).done(function(resp) {
					console.log(resp);
				
					var info = resp[0];
					var tbody = $(".clinicPatientInfo");
					
					tbody.empty();
					patntSearchView(tbody, info);
					

			
						}); /*getJson  */

					});/*documentClick  */
					
			/*두번째탭 환자상세정보검색 end  */
		

// 검사예약조회에서 환자 검색
	$(document).on("click",".examRezBtn",function() {
			var patntCode = $(this).data("ecode");

			console.log(patntCode);

		$.getJSON("<c:url value='/rez/rezPatntInfo.do' />",{patntCode : patntCode}).done(function(resp) {
						var info = resp[0];
						var tbody = $(".examPatientInfo");

						tbody.empty();
						patntSearchView(tbody, info);
	});/*getJson  */
	
});/*docu  */
	

		//오늘 날짜 가져오기
		var today = new Date();
		var year = today.getFullYear();
		var month = String(today.getMonth() + 1).padStart(2, '0');
		var day = String(today.getDate()).padStart(2, '0');

		let defaultResveDate = year + '-' + month + '-' + day;
		console.log("defaultResveDate:", defaultResveDate);
		loadClinicTimeTable(defaultResveDate);
		loadExamTimeTable(defaultResveDate);

		//진료과 시간표 리셋
		$("#clinicResetBtn").on("click", function() {
			loadClinicTimeTable(defaultResveDate);

		});

		//검사실 시간표 리셋
		$("#examResetBtn").on("click", function() {
			loadClinicTimeTable(defaultResveDate);

		});
			
		//전체예약조회 탭 클릭시 환자정보 테이블 초기화
		$("#list-viewBtn").on("click", function() {
			var tbody = $(".patientInfo");
			tbody.empty();
 			var info = [" ", " "," "," "," "," "," "," "," "," "," ",];
			defautltPatntSearchView1(tbody, info);
			
			

		});
		
		//진료과예약조회 탭 클릭시 환자정보 테이블 초기화
		$("#clinicGrid-viewBtn").on("click", function() {
			var tbody = $(".clinicPatientInfo");
			tbody.empty();
			var info = [" ", " "," "," "," "," "," "," "," "," "," ",];
			defautltPatntSearchView2(tbody, info);
			

		});
		//검사실 예약조회 탭 클릭시 환자정보 테이블 초기화
		$("#examGrid-viewBtn").on("click", function() {
			var tbody = $(".examPatientInfo");
			tbody.empty();
			var info = [" ", " "," "," "," "," "," "," "," "," "," ",];
			defautltPatntSearchView3(tbody, info);
		});


		//시간표 탭 클릭시 환자정보 테이블 초기화
		$("#ttGrid-viewBtn").on("click", function() {

		});

		//두번째 외래 진료과 조회탭 리셋 클릭시 환자정보 테이블 초기화
		$("#clinicResetBtn").on("click", function() {
			loadReset2Table();
		});
		
		
		//세번째 검사 예약조회탭 리셋 클릭시 환자정보 테이블 초기화
		$("#rezExamResetBtn").on("click", function() {
			loadReset3Table();
		});
		
		
		function patntSearchView(tbody, info) {
			
			     
   			     var firstRow = tbody.eq(0);
			     var secondRow = tbody.eq(1);
			     var thirdRow = tbody.eq(2);
			     var fourthRow = tbody.eq(3);
			     var fifthRow = tbody.eq(4);
			     var sixRow = tbody.eq(5);
			     var sevenRow = tbody.eq(6);
			     var eightRow = tbody.eq(7);
			     var nineRow = tbody.eq(8);
			     var tenRow = tbody.eq(9);
			     
			     
			     var firstRow = $("<tr>").append(
			    		    $("<th>").html("성명(성별)"),
			    		    $("<td>").html(info.patntNm + "&nbsp;(" + info.gen +")")
			    		);
			    		tbody.append(firstRow);

			    		var secondRow = $("<tr>").append(
			    		    $("<th>").html("식별코드"),
			    		    $("<td>").html(info.patntCode)
			    		);
			    		tbody.append(secondRow);
			    		
			    		
			    		var thirdRow = $("<tr>").append(
				    		    $("<th>").html("주민번호"),
				    		    $("<td>").html(info.birthCode+" ("+info.age+")")
				    		);
				    		tbody.append(thirdRow);
					
				    	var fourRow = $("<tr>").append(
				    				$("<th>").html("연&nbsp;&nbsp;락&nbsp;&nbsp;처"),
								    $("<td>").html(info.patntTelno)
					    		);
					    		tbody.append(fourRow);
			
						
					    var fifthRow = $("<tr>").append(

								$("<th>").html("이&nbsp;&nbsp;메&nbsp;&nbsp;일"),
							    $("<td>").html(info.patEmail)
						    		);
						    		tbody.append(fifthRow);

						var sixRow = $("<tr>").append(
								$("<th>").html("주&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;소"),
							    $("<td>").html(info.patntAddr1)
								);
								tbody.append(sixRow);
						
						var sevenRow = $("<tr>").append(
								$("<th>").html("최초등록일"),
							    $("<td>").html(info.fpatntRegist)
							);
							tbody.append(sevenRow);
							
						var eightRow = $("<tr>").append(	
								$("<th>").html("다음진료일"),
							    $("<td>").html(info.fresveDate)
							);
						     tbody.append(eightRow);
						     
							var nineRow = $("<tr>").append(	
									$("<th>").html("담&nbsp;당&nbsp;과"),
								    $("<td>").html(info.fcltyNm)
							);
						     tbody.append(nineRow);
						
							var tenRow = $("<tr>").append(	
								$("<th>").html("신장/체중"),
							    $("<td>").html(info.height
									+ "&nbsp;/&nbsp;"
									+ info.weight
									)  
									
							);

						 tbody.append(tenRow);
				
			
				}
	
		
		function loadReset2Table() {
				var tbody = $(".clinicPatientInfo");
				tbody.empty();
				
				tbody.append(
				$("<tr>").html(
					$("<td colspan='11'>").html("환자이름을 선택하세요")		
					)		
				);
			
		}
		
		//예약조회 환자정보 조회탭 초기화
		function loadReset3Table() {
				var tbody = $(".examPatientInfo");
				tbody.empty();
				
				tbody.append(
				$("<tr>").html(
					$("<td colspan='11'>").html("환자이름을 선택하세요")		
					)		
				);
			
		}/*loadPatient() end  */
			
			
			
			
		//진료과 시간표 예약환자 로드(오늘날짜로 기본세팅)
		function loadClinicTimeTable(resveDate) {
		
		 $(".schedule-item").empty();
     	 $(".schedule-item").css({
			    "background-color": "white",
			    "border": "none" 
			});


		
			$.getJSON("<c:url value='/rez/clinicTimeTable.do' />", {
				resveDate : resveDate
			}).done(function(resp) {

				console.log(resp);
				var data = resp;
				console.log(data);

				var itemsSchedule = [];

				$(resp).each(function(idx, data) {

					var patntCode='data.patntCode';
					var resveNum='data.resveNum';
					var resveDate='data.resveDate';
					var resveTime='data.resveTime';
					var resveEndTime='data.resveEndTime';
					var fcltyCode='data.fcltyCode';
					
					
					console.log(data);
					var bgColor;

					switch (data.fcltyNm) {
					case "sunday":
						bgColor = "red";
						break;
					case "monday":
						bgColor = "blue";
						break;
					case "tuesday":
						bgColor = "purple";
						break;
					case "wednesday":
						bgColor = "green";
						break;
					case "thursday":
						bgColor = "yellow";
						break;
					case "friday":
						bgColor = "red";
						break;
					case "saturday":
						bgColor = "blue";
						break;
					default:
						bgColor = "blue";
						break;
					}

					var item = {
						patntCode : data.patntCode,
						resveNum : data.resveNum,
						keyfrom : data.resveTime,
						keyto : data.resveEndtime,
						text : data.patntNm,
						bg : bgColor,
						days : [ data.fcltyNm ]
					};

					itemsSchedule.push(item);

					console.log("itemsSchedule>", itemsSchedule);

					
						
					});
				
				itemsSchedule.forEach(function(sitem, index) {

					var sday = sitem.days;
					$("#clinic").append(
							 '<div class="schedule-item'
						    + ' schedule-' + sday
						    + ' time-from-' + sitem.keyfrom
						    + ' time-to-' + sitem.keyto
						    + ' nt bg-' + sitem.bg + '">'
						    + '<button type="button"data-bs-toggle="modal" data-bs-target="#draggableModal" class="btn rezUpdateBtn" data-patntcode="' + sitem.patntCode + '" value="' + sitem.resveNum + '">' + sitem.text + '</button>'
						    + '</div>'
						);

				}); //resp 반복문

			}); //getJson

		} //function loadClinicTimeTable

		//clinifcResveDate 
		
				
		//진료과 시간표 예약환자 로드(검색한 날짜파라미터), 예약취소 후 새로고침용
		function deleteRezAfterLoadClinicTimeTable(resveDate) {
		
		 $(".schedule-item").empty();
     	 $(".schedule-item").css({
			    "background-color": "white",
			    "border": "none" 
			});


		
			$.getJSON("<c:url value='/rez/clinicTimeTable.do' />", {
				resveDate : resveDate
			}).done(function(resp) {

				console.log(resp);
				var data = resp;
				console.log(data);

				var itemsSchedule = [];

				$(resp).each(function(idx, data) {

					var patntCode='data.patntCode';
					var resveNum='data.resveNum';
					var resveDate='data.resveDate';
					var resveTime='data.resveTime';
					var resveEndTime='data.resveEndTime';
					var fcltyCode='data.fcltyCode';
					
					
					console.log(data);
					var bgColor;

					switch (data.fcltyNm) {
					case "sunday":
						bgColor = "red";
						break;
					case "monday":
						bgColor = "blue";
						break;
					case "tuesday":
						bgColor = "purple";
						break;
					case "wednesday":
						bgColor = "green";
						break;
					case "thursday":
						bgColor = "yellow";
						break;
					case "friday":
						bgColor = "red";
						break;
					case "saturday":
						bgColor = "blue";
						break;
					default:
						bgColor = "blue";
						break;
					}

					var item = {
						patntCode : data.patntCode,
						resveNum : data.resveNum,
						keyfrom : data.resveTime,
						keyto : data.resveEndtime,
						text : data.patntNm,
						bg : bgColor,
						days : [ data.fcltyNm ]
					};

					itemsSchedule.push(item);

					console.log("itemsSchedule>", itemsSchedule);

					
						
					});
				
				itemsSchedule.forEach(function(sitem, index) {

					var sday = sitem.days;
					$("#clinic").append(
							 '<div class="schedule-item'
						    + ' schedule-' + sday
						    + ' time-from-' + sitem.keyfrom
						    + ' time-to-' + sitem.keyto
						    + ' nt bg-' + sitem.bg + '">'
						    + '<button type="button"data-bs-toggle="modal" data-bs-target="#draggableModal" class="btn rezUpdateBtn" data-patntcode="' + sitem.patntCode + '" value="' + sitem.resveNum + '">' + sitem.text + '</button>'
						    + '</div>'
						);

				}); //resp 반복문

			}); //getJson

		} //function loadClinicTimeTable

		//clinifcResveDate 
		
		
		
		
		
		
		//검사실 시간표 로드
			function loadExamTimeTable(resveDate) {
			$(".schedule-item").empty();
		    $(".schedule-item").css({
				"background-color": "white",
				"border": "none" 
				});

			$.getJSON("<c:url value='/rez/examTimeTable.do' />", {resveDate : resveDate}).done(function(resp) { 
				
				var data = resp; 
				
				
				
				var itemsSchedule = [];

				$(resp).each(function(idx, data) {
					
					
					var patntCode='data.patntCode';
					var resveNum='data.resveNum';
					var resveDate='data.resveDate';
					var resveTime='data.resveTime';
					var resveEndTime='data.resveEndTime';
					var fcltyCode='data.fcltyCode';
					
					
					
					var bgColor;

					switch (data.fcltyNm) {
					case "sunday":
						bgColor = "red";
						break;
					case "monday":
						bgColor = "blue";
						break;
					case "tuesday":
						bgColor = "purple";
						break;
					case "wednesday":
						bgColor = "yellow";
						break;
					case "thursday":
						bgColor = "green";
						break;
					case "friday":
						bgColor = "yellow";
						break;
					case "saturday":
						bgColor = "yellow";
						break;
					default:
						bgColor = "yellow";
						break;
					}

					var item = {
						patntCode : data.patntCode,
						resveNum : data.resveNum,
						keyfrom : data.resveTime,
						keyto : data.resveEndtime,
						text : data.patntNm,
						bg : bgColor,
					
						days : [ data.fcltyNm ]
					};

					itemsSchedule.push(item);

					console.log("itemsSchedule>", itemsSchedule);

						
					});


				itemsSchedule.forEach(function(sitem, index) {

					var sday = sitem.days;
					$("#exam").append(
						    '<div class="schedule-item'
						    + ' schedule-' + sday
						    + ' time-from-' + sitem.keyfrom
						    + ' time-to-' + sitem.keyto
						    + ' nt bg-' + sitem.bg + '">'
						    + '<button type="button"data-bs-toggle="modal" data-bs-target="#draggableModal" class="btn rezUpdateBtn" data-patntcode="' + sitem.patntCode + '" value="' + sitem.resveNum + '">' + sitem.text + '</button>'
						    + '</div>'
						);
						





				
				}); //resp 반복문

			}); //getJson

		} //function loadExamTimeTable
		

		//진료과 시간표 날짜검색(날짜 미선택 시 알림창)
		$("#clinicTTBtn").on("click", function() {
			var clinicResveDate = $("#clinicTTResveDate").val();
			  if (clinicResveDate === "") {
		            Swal.fire('조회날짜를 선택하세요.');
		            event.preventDefault(); // 폼 제출 막기
		        } else{
					loadClinicTimeTable(clinicResveDate);
		        }
		});

		//검사실 시간표 탭 날짜검색(날짜 미선택 시 알림창)
		$("#examTTBtn").on("click", function() {
			var examResveDate = $("#examTTResveDate").val();
			
		        if (examResveDate === "") {
		            Swal.fire('조회날짜를 선택하세요.');
		            event.preventDefault(); // 폼 제출 막기
		        } else{
			        loadExamTimeTable(examResveDate);
		        }
		});

		//페이징 start
		$('#patient-table').addClass('nowrap').dataTable({
			responsive : true,
			columnDefs : [ {
				targets : [ -1, -3 ],
				className : 'dt-body-right'
			} ]
		});

		$('#myProjectTable').addClass('nowrap').dataTable({
			responsive : true,
			columnDefs : [ {
				targets : [ -1, -3 ],
				className : 'dt-body-right'
			} ]
		});

		$('#myProjectTable2').addClass('nowrap').dataTable({
			responsive : true,
			columnDefs : [ {
				targets : [ -1, -3 ],
				className : 'dt-body-right'
			} ]
		});

		//페이징 end

		
		//첫번째 예약조회 탭에서 예약시간 출력형식 변경 00:00
		 
		      var resveTimeElements = document.querySelectorAll('.resveTime');
		      var resveEndtimeElements = document.querySelectorAll('.resveEndtime');

		      resveTimeElements.forEach(function(element) {
		         var resveTime = element.getAttribute('data-time');
		         var formattedTime = resveTime.substring(0, 2) + ':'
		               + resveTime.substring(2);
		         element.textContent = formattedTime;
		      });

		      resveEndtimeElements.forEach(function(element) {
		         var resveEndtime = element.getAttribute('data-endtime');
		         var formattedEndtime = resveEndtime.substring(0, 2) + ':'
		               + resveEndtime.substring(2);
		         element.textContent = formattedEndtime;
		      });
		
	
		      
		      
		    const urlParams = new URLSearchParams(window.location.search);
		  	const recCode = urlParams.get('recCode');

		  	const Toast = Swal.mixin({
		  	    toast: true,
		  	    position: 'center-center',
		  	    showConfirmButton: false,
		  	    timer: 1000,
		  	    timerProgressBar: true,
		  	    didOpen: (toast) => {
		  	        toast.addEventListener('mouseenter', Swal.stopTimer)
		  	        toast.addEventListener('mouseleave', Swal.resumeTimer)
		  	    }
		  	});	
		      
		
	});//$(document).ready(function()
			
			
</script>
